function EvWeapon(a,b)
{
	this.id=a;
	this.weapon_name=b.weapon_name;
	this.skin_name=b.skin_name;
	this.rarity=b.rarity;
	this.steam_image=b.steam_image;
	this.el=null
}
EvWeapon.EL_WIDTH=200;
function EvRoulette(a)
{
	this.weapon_prize_attrs=a.weapon_prize_attrs;
	this.weapon_actors_attrs=a.weapon_actors_attrs;
	this.weapons=[];
	this.el_parent=a.el_parent;
	this.el_weapons=this.el=null;
	this.beforeparty=a.beforeparty;
	this.afterparty=a.afterparty
}
EvRoulette.N_WEAPONS=35;
EvRoulette.WEAPON_PRIZE_ID=EvRoulette.N_WEAPONS-3;

EvRoulette.SPIN_SECS=10;
EvRoulette.START_DELAY_MSECS=100;
EvRoulette.SOUND_SPIN_INTERVAL=100;
EvRoulette.IMAGE_LOAD_INTERVAL=500;
EvRoulette.IMAGE_LOAD_WAIT_MSECS=1E4;
EvRoulette.SOUND_START="../case_roulette/snd/roulette_start.wav";
EvRoulette.SOUND_SPIN="../case_roulette/snd/roulette_spin.wav";
EvRoulette.SOUND_STOP="../case_roulette/snd/roulette_stop.wav";
EvRoulette.prototype.set_weapons=function()
{
	var a=this,
	b=[],
	d=a.weapon_actors_attrs.length,
	e=0,
	g=function(g,c)
	{
		var h;
		for(h=g;h<=c;h+=1)b[h]=new EvWeapon(h,a.weapon_actors_attrs[e]),e=e===d-1?0:e+1
	};
	if(0===d)throw Error("\u041e\u0448\u0438\u0431\u043a\u0430! \u041d\u0435\u0442 \u0430\u043a\u0442\u0451\u0440\u043e\u0432.");g(0,EvRoulette.WEAPON_PRIZE_ID-1);b[EvRoulette.WEAPON_PRIZE_ID]=new EvWeapon(EvRoulette.WEAPON_PRIZE_ID,a.weapon_prize_attrs);g(EvRoulette.WEAPON_PRIZE_ID+1,EvRoulette.N_WEAPONS-
1);a.weapons=b
};
EvRoulette.prototype.render=function()
{
	var a=this,
	b=document.createElement("div"),
	d=document.createElement("div"),e=document.createElement("div"),g=0,f=0,c;b.id="ev-roulette";d.id="ev-target";e.id="ev-weapons";e.style.width=EvRoulette.N_WEAPONS*EvWeapon.EL_WIDTH+"px";a.weapons.forEach(function(a){var b=document.createElement("div"),c=document.createElement("div"),d=document.createElement("div"),f=document.createElement("img"),k=document.createElement("div"),l=document.createElement("p"),m=document.createElement("p");
f.onload=function(){g+=1};f.src=a.steam_image;f.alt=a.weapon_name;l.textContent=a.weapon_name;m.textContent=a.skin_name;b.className="ev-weapon";c.className="ev-weapon-inner";d.className="ev-weapon-rarity ev-weapon-rarity-"+a.rarity;k.className="ev-weapon-text";k.appendChild(l);k.appendChild(m);c.appendChild(d);c.appendChild(f);c.appendChild(k);b.appendChild(c);a.el=b;e.appendChild(a.el)});b.appendChild(d);b.appendChild(e);c=setInterval(function(){f+=EvRoulette.IMAGE_LOAD_INTERVAL;if(g===EvRoulette.N_WEAPONS||
f>=EvRoulette.IMAGE_LOAD_WAIT_MSECS)clearInterval(c),a.el_weapons=e,a.el=b,a.el_parent.appendChild(a.el),a.spin()},EvRoulette.IMAGE_LOAD_INTERVAL)};EvRoulette.prototype.make_sound=function(a){a=new Audio(a);a.volume=.2;a.play()};
EvRoulette.prototype.spin=function(){var a=this,b=Math.floor(EvWeapon.EL_WIDTH/2),d=Math.floor(EvWeapon.EL_WIDTH/20),e=(EvRoulette.N_WEAPONS-5)*EvWeapon.EL_WIDTH+b+(Math.floor(Math.random()*(18*d-d+1))+d),g,f=0;a.el_weapons.style.transition="left "+EvRoulette.SPIN_SECS+"s ease-out";setTimeout(function(){a.beforeparty();a.make_sound(EvRoulette.SOUND_START);a.el_weapons.style.left="-"+e+"px";g=setInterval(function(){var c=Math.abs(parseInt(window.getComputedStyle(a.el_weapons).left,10)),c=Math.floor((c+
b)/EvWeapon.EL_WIDTH);c>f&&(f=c,a.make_sound(EvRoulette.SOUND_SPIN))},EvRoulette.SOUND_SPIN_INTERVAL)},EvRoulette.START_DELAY_MSECS);a.el_weapons.addEventListener("transitionend",function(){clearInterval(g);a.make_sound(EvRoulette.SOUND_STOP);a.weapons.forEach(function(a){a.id!==EvRoulette.WEAPON_PRIZE_ID&&(a.el.style.opacity=.5)});a.afterparty()})};EvRoulette.prototype.start=function(){this.set_weapons();this.render()};